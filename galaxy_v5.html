<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>La Galaxie Vivante ‚Äî V5 (pr√©paration Multijoueur)</title>

  <!-- React 17 + Babel pour JSX inline -->
  <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind pour styles rapides -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    html,body { height:100%; margin:0; background: radial-gradient(ellipse at bottom, #020419 0%, #00030a 60%, #000 100%); color:#e6f0ff; font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; overflow:hidden; }
    #root { width:100%; height:100vh; position:relative; }
    .star { transition: transform 0.12s, box-shadow 0.12s, filter 0.12s; will-change: transform; }
    .star:hover { transform: scale(1.28); z-index:80; }
    .halo { filter: blur(6px) saturate(120%); opacity:0.9; }
    .notif { animation: pop .35s ease-out; }
    @keyframes pop { from { transform: translateY(8px); opacity:0 } to { transform: translateY(0); opacity:1 } }
    .journal::-webkit-scrollbar { width:8px }
    .journal::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); border-radius:8px }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
  const { useState, useEffect, useRef } = React;

  /* ==========================
     CONFIGURATION CLOUD (placer tes valeurs Supabase ici plus tard)
     - SUPABASE_URL: ex. "https://xyzcompany.supabase.co"
     - SUPABASE_KEY: clef anon publique (fourni par Supabase)
     Quand ces 2 valeurs sont non vides, le jeu tentera de communiquer.
     ========================== */
  const SUPABASE_URL = "";   // <-- remplis ici plus tard pour activer cloud
  const SUPABASE_KEY = "";   // <-- remplis ici plus tard pour activer cloud
  const REMOTE_TABLE = "galaxy_shared"; // nom de table √† cr√©er plus tard (docs fournis)

  /* ---------- petits utilitaires ---------- */
  const rand = (a,b) => Math.random()*(b-a)+a;
  const randint = (a,b) => Math.floor(rand(a,b+1));
  const clamp = (v,a,b) => Math.max(a, Math.min(b, v));
  const now = () => Date.now();

  const WORLD = { SIZE: 3400, BASE_COUNT: 32 };

  const syll = ["zor","kan","vel","tor","lin","rax","mer","ion","tal","quor","xen","phi","lun","dra","ora","esh","nar","sol","vak"];
  const randomName = () => syll[Math.floor(Math.random()*syll.length)] + syll[Math.floor(Math.random()*syll.length)] + "-" + randint(1,999);
  const nextId = (() => { let i=0; return () => 'S' + (++i); })();

  /* ---------- cr√©ation d'une √©toile/civilisation ---------- */
  function generateStar(){
    const lvl = randint(0,3);
    const aligns = ['pacifique','conqu√©rant','nomade','scientifique','isolationniste'];
    const align = aligns[randint(0,aligns.length-1)];
    return {
      id: nextId(),
      name: randomName(),
      x: Math.floor(rand(80, WORLD.SIZE-80)),
      y: Math.floor(rand(80, WORLD.SIZE-80)),
      population: Math.floor(rand(10_000, 2_500_000)),
      civLevel: lvl,
      alignment: align,
      energy: Math.floor(rand(120, 700)),
      status: 'stable', // stable | unrest | war | expansion | collapsed
      relations: {}, // id -> score
      lastEvent: null,
      owner: null // null = non-joueur / communal ; plus tard: player id
    };
  }

  function createGalaxy(n = WORLD.BASE_COUNT) {
    const arr = [];
    for(let i=0;i<n;i++) arr.push(generateStar());
    // initialiser relations
    for(const a of arr){
      for(const b of arr){
        if (a.id === b.id) continue;
        const d = Math.hypot(a.x-b.x, a.y-b.y);
        a.relations[b.id] = Math.floor(clamp(100 - d/40 + rand(-10,10), -80, 100));
      }
    }
    return arr;
  }

  /* ---------- LOGIQUE: √©volution locale (comme pr√©c√©demment) ---------- */
  function evolveGalaxy(galaxy, hours) {
    return galaxy.map(s => {
      const ns = {...s};
      let baseGrowth = 1 + 0.0008*(ns.civLevel+1);
      if (ns.status === 'expansion') baseGrowth += 0.01;
      if (ns.status === 'war') baseGrowth -= 0.02;
      ns.population = Math.max(0, Math.floor(ns.population * Math.pow(1+(baseGrowth-1), hours)));
      ns.energy = Math.max(0, Math.floor(ns.energy + (hours * randint(-5,10))));
      if (Math.random() < 0.015 * hours * (1 + ns.civLevel/8)) ns.civLevel = Math.min(6, ns.civLevel + 1);
      if (Math.random() < 0.012 * hours) {
        const r = Math.random();
        ns.status = r < 0.5 ? 'stable' : r < 0.8 ? 'expansion' : 'unrest';
      }
      if (Math.random() < 0.0007 * hours) {
        ns.status = 'collapsed';
        ns.population = Math.floor(ns.population * 0.08);
      }
      ns.lastEvent = `Evolu√© ${hours}h`;
      return ns;
    });
  }

  /* ---------- FONCTIONS REMOTE (stubs / pr√©par√©es pour Supabase REST) ---------- */
  // NOTE: ces fonctions ne font RIEN si SUPABASE_URL || SUPABASE_KEY sont vides.
  async function pushRemote(sharedId, payload){
    if (!SUPABASE_URL || !SUPABASE_KEY) {
      console.info("pushRemote: remote disabled (no keys).");
      return { ok: false, reason: "no-keys" };
    }
    // Ex: utiliser table 'galaxy_shared' avec colonnes (id, data jsonb, updated_at)
    try {
      const url = `${SUPABASE_URL}/rest/v1/${REMOTE_TABLE}`;
      // Upsert: on veut cr√©er ou remplacer la ligne ayant id = sharedId
      // Requires supabase anon key and RLS/policies prepared.
      const body = { id: sharedId, data: JSON.stringify(payload) };
      const res = await fetch(url, {
        method: 'POST',
        headers: {
          'apikey': SUPABASE_KEY,
          'Authorization': `Bearer ${SUPABASE_KEY}`,
          'Content-Type': 'application/json',
          'Prefer': 'resolution=merge-duplicates' // supabase upsert behavior
        },
        body: JSON.stringify(body)
      });
      const json = await res.json();
      return { ok: true, data: json };
    } catch (err) {
      console.error("pushRemote error", err);
      return { ok: false, reason: err.message };
    }
  }

  async function pullRemote(sharedId){
    if (!SUPABASE_URL || !SUPABASE_KEY) {
      console.info("pullRemote: remote disabled (no keys).");
      return { ok: false, reason: "no-keys" };
    }
    try {
      const url = `${SUPABASE_URL}/rest/v1/${REMOTE_TABLE}?id=eq.${encodeURIComponent(sharedId)}&select=data`;
      const res = await fetch(url, {
        headers: {
          'apikey': SUPABASE_KEY,
          'Authorization': `Bearer ${SUPABASE_KEY}`
        }
      });
      if (!res.ok) return { ok: false, reason: res.statusText };
      const json = await res.json();
      if (json.length === 0) return { ok: false, reason: 'not-found' };
      const parsed = JSON.parse(json[0].data);
      return { ok: true, data: parsed };
    } catch (err) {
      console.error("pullRemote error", err);
      return { ok: false, reason: err.message };
    }
  }

  /* ---------- Composants UI (map, panels) ---------- */
  function GalaxyMap({ galaxy, onSelect, camera, setCamera, highlighted }) {
    const ref = useRef(null);
    const dragging = useRef(false);
    const last = useRef({x:0,y:0});

    useEffect(() => {
      const el = ref.current;
      if (!el) return;
      const onWheel = (e) => {
        e.preventDefault();
        const delta = -e.deltaY;
        const zoomFactor = delta > 0 ? 1.08 : 0.92;
        const rect = el.getBoundingClientRect();
        const mx = e.clientX - rect.left;
        const my = e.clientY - rect.top;
        const worldX = (mx - camera.x) / camera.scale;
        const worldY = (my - camera.y) / camera.scale;
        const newScale = clamp(camera.scale * zoomFactor, 0.35, 2.2);
        const nx = mx - worldX * newScale;
        const ny = my - worldY * newScale;
        setCamera(prev => ({...prev, scale:newScale, x:nx, y:ny}));
      };
      el.addEventListener('wheel', onWheel, { passive:false });
      return () => el.removeEventListener('wheel', onWheel);
    }, [camera, setCamera]);

    const onPointerDown = (e) => { dragging.current = true; last.current = {x:e.clientX, y:e.clientY}; };
    const onPointerMove = (e) => {
      if (!dragging.current) return;
      const dx = e.clientX - last.current.x;
      const dy = e.clientY - last.current.y;
      last.current = {x:e.clientX, y:e.clientY};
      setCamera(c => ({...c, x: c.x + dx, y: c.y + dy}));
    };
    const onPointerUp = () => { dragging.current = false; };

    const transform = `translate(${camera.x}px, ${camera.y}px) scale(${camera.scale})`;

    return (
      <div ref={ref} className="absolute inset-0" onPointerDown={onPointerDown} onPointerMove={onPointerMove} onPointerUp={onPointerUp} style={{ touchAction:'none' }}>
        <div style={{
          position:'absolute',
          left:(window.innerWidth - WORLD.SIZE)/2,
          top:(window.innerHeight - WORLD.SIZE)/2,
          width: WORLD.SIZE,
          height: WORLD.SIZE,
          transform,
          transformOrigin: '0 0',
          transition: dragging.current ? 'none' : 'transform 0.06s'
        }}>
          {/* subtle starfield */}
          <div style={{position:'absolute', left:0, top:0, width:WORLD.SIZE, height:WORLD.SIZE, background:
            'radial-gradient(circle at 20% 20%, rgba(255,255,255,0.02), transparent 30%), radial-gradient(circle at 70% 80%, rgba(255,255,255,0.01), transparent 20%)' }} />
          {[...Array(140)].map((_,i)=>(
            <div key={i} style={{ position:'absolute', left: rand(0, WORLD.SIZE), top: rand(0, WORLD.SIZE), width: Math.random()*2+0.5, height: Math.random()*2+0.5, borderRadius:999, background:'rgba(255,255,255,0.05)' }} />
          ))}

          {galaxy.map(s => {
            const size = clamp(6 + Math.log10(Math.max(1, s.population))/1.05, 6, 40);
            const alignHue = s.alignment === 'conqu√©rant' ? '#ffb86b' : s.alignment === 'scientifique' ? '#b4a7ff' : s.alignment === 'pacifique' ? '#6ee7b7' : s.alignment === 'nomade' ? '#ffd86b' : '#9aa6ff';
            const color = s.status === 'collapsed' ? '#555' : alignHue;
            const haloSize = size * (1 + (s.civLevel/8));
            const border = s.owner ? '2px solid rgba(255,255,255,0.15)' : '1px solid rgba(255,255,255,0.06)';
            return (
              <div key={s.id} className="star" onClick={(e)=>{ e.stopPropagation(); onSelect(s); }} title={`${s.name} ‚Ä¢ civ ${s.civLevel} ‚Ä¢ ${s.alignment}`} style={{
                position:'absolute', left: s.x - size/2, top: s.y - size/2, width: size, height: size, borderRadius:999, background: color, display:'flex', alignItems:'center', justifyContent:'center',
                fontSize:Math.min(14, size-4), fontWeight:800, color:'#021', boxShadow: highlighted === s.id ? '0 10px 30px rgba(0,0,0,0.7)' : 'none', cursor:'pointer', border
              }}>
                <div className="halo" style={{ position:'absolute', left:-((haloSize-size)/2), top:-((haloSize-size)/2), width: haloSize, height: haloSize, borderRadius:999, background: color, opacity: 0.06, zIndex:-1 }} />
                <div style={{ position:'absolute', right:-8, top:-8, fontSize:9, background:'rgba(0,0,0,0.45)', padding:'2px 4px', borderRadius:6 }}>{s.civLevel}</div>
                {s.owner && <div style={{ position:'absolute', left:-8, bottom:-8, fontSize:9, background:'rgba(0,0,0,0.45)', padding:'2px 4px', borderRadius:6 }}>üë§</div>}
              </div>
            );
          })}
        </div>
      </div>
    );
  }

  /* ---------- MAIN APP (local-first, cloud-ready) ---------- */
  function App(){
    const [galaxy, setGalaxy] = useState([]);
    const [selected, setSelected] = useState(null);
    const [log, setLog] = useState([]);
    const [notif, setNotif] = useState(null);
    const [camera, setCamera] = useState({ x: 0, y: 0, scale: 0.95 });
    const [highlighted, setHighlighted] = useState(null);
    const [syncMode, setSyncMode] = useState(SUPABASE_URL && SUPABASE_KEY ? 'cloud' : 'local'); // 'local' or 'cloud'
    const [sharedId, setSharedId] = useState('galaxy_global_v1'); // id used remotely to store shared galaxy

    // load or create local; if cloud keys exist, try pullRemote
    useEffect(() => {
      const local = localStorage.getItem("galaxy_v5_local");
      const last = localStorage.getItem("galaxy_v5_last");
      async function init(){
        if (SUPABASE_URL && SUPABASE_KEY) {
          setSyncMode('cloud');
          // try to pull remote; if none, fall back to local or new
          const r = await pullRemote(sharedId);
          if (r.ok) {
            setGalaxy(r.data);
            pushLog("Galaxie charg√©e depuis le cloud.");
          } else if (local) {
            setGalaxy(JSON.parse(local));
            pushLog("Cloud vide ‚Üí chargement local.");
          } else {
            const g = createGalaxy();
            setGalaxy(g);
            pushLog("Nouvelle galaxie (cloud initialis√©e).");
          }
        } else {
          setSyncMode('local');
          if (local) {
            let g = JSON.parse(local);
            if (last) {
              const hours = Math.floor((now() - parseInt(last,10)) / 3600000);
              if (hours > 0) {
                g = evolveGalaxy(g, hours);
                pushLog(`${hours}h √©coul√©es ‚Äî √©volution locale appliqu√©e.`);
                setNotif(`${hours}h appliqu√©es`);
              }
            }
            setGalaxy(g);
            pushLog("Galaxie charg√©e localement.");
          } else {
            const g = createGalaxy();
            setGalaxy(g);
            localStorage.setItem("galaxy_v5_local", JSON.stringify(g));
            pushLog("Nouvelle galaxie locale cr√©√©e.");
          }
        }
        localStorage.setItem("galaxy_v5_last", now());
      }
      init();
    }, []);

    // autosave local & optionally push to remote
    useEffect(() => {
      const t = setInterval(async () => {
        localStorage.setItem("galaxy_v5_local", JSON.stringify(galaxy));
        localStorage.setItem("galaxy_v5_last", now());
        if (syncMode === 'cloud' && SUPABASE_URL && SUPABASE_KEY) {
          // push periodically (best-effort)
          const p = await pushRemote(sharedId, galaxy);
          if (p.ok) pushLog("Sync cloud automatique.");
        }
      }, 10000);
      return ()=>clearInterval(t);
    }, [galaxy, syncMode]);

    // events generator (local simulation + AI)
    useEffect(() => {
      const t = setInterval(() => {
        if (galaxy.length === 0) return;
        const index = randint(0, galaxy.length-1);
        const star = galaxy[index];
        // tiny event: small pop change and message
        const change = Math.floor(star.population * rand(-0.02, 0.04));
        const updated = galaxy.map(s => s.id === star.id ? {...s, population: Math.max(0, s.population + change), lastEvent: `√âv√©nement local`} : s);
        setGalaxy(updated);
        pushLog(`${star.name}: variation ${change >= 0 ? '+' : ''}${change}`);
        setHighlighted(star.id);
        setTimeout(()=>setHighlighted(null), 2500);
      }, 7000);
      return ()=>clearInterval(t);
    }, [galaxy]);

    // notif timeout
    useEffect(()=>{ if (!notif) return; const t=setTimeout(()=>setNotif(null),4200); return ()=>clearTimeout(t); }, [notif]);

    function pushLog(t){ setLog(l => [ `${new Date().toLocaleTimeString()} ‚Äî ${t}`, ...l].slice(0,200)); }

    /* ---------- actions joueur (local-first) ---------- */
    const claimSystem = (starId, playerName="Joueur") => {
      setGalaxy(g => g.map(s => s.id === starId ? {...s, owner: playerName, lastEvent: `Colonis√© par ${playerName}`} : s));
      pushLog(`Vous avez colonis√© le syst√®me.`);
      setNotif("Syst√®me colonis√©");
    };

    const exploreSystem = (starId) => {
      // exploration = chance de d√©couverte
      setGalaxy(g => g.map(s => {
        if (s.id !== starId) return s;
        const found = Math.random() < 0.38;
        const delta = found ? Math.floor(s.population * rand(0.03,0.12)) : Math.floor(s.population * rand(-0.02,0.02));
        return {...s, population: Math.max(0, s.population + delta), lastEvent: found ? "D√©couverte trouv√©e" : "Exploration neutre"};
      }));
      pushLog("Exp√©dition d'exploration lanc√©e.");
      setNotif("Exploration");
    };

    const sendAid = (starId) => {
      setGalaxy(g => g.map(s => s.id === starId ? {...s, population: Math.floor(s.population*1.06), lastEvent: 'Aide re√ßue'} : s));
      pushLog("Aide envoy√©e.");
      setNotif("Aide envoy√©e");
    };

    const declareWar = (starId) => {
      setGalaxy(g => g.map(s => s.id === starId ? {...s, status:'war', lastEvent:'D√©clar√© en guerre'} : s));
      pushLog("Guerre d√©clar√©e.");
      setNotif("Guerre !");
    };

    /* ---------- UI helpers pour remote ---------- */
    async function manualPullRemote(){
      const r = await pullRemote(sharedId);
      if (r.ok) { setGalaxy(r.data); pushLog("Galaxie synchronis√©e depuis le cloud."); setNotif("Pull cloud OK"); }
      else { pushLog("Pull cloud √©chou√©: " + (r.reason || '')); setNotif("Pull √©chou√©"); }
    }
    async function manualPushRemote(){
      const r = await pushRemote(sharedId, galaxy);
      if (r.ok) { pushLog("Galaxie envoy√©e au cloud."); setNotif("Push cloud OK"); }
      else { pushLog("Push cloud √©chou√©: " + (r.reason || '')); setNotif("Push √©chou√©"); }
    }

    /* ---------- small controls ---------- */
    const addSystem = () => {
      const s = generateStar();
      // set initial relations with existing
      setGalaxy(g => {
        for(const o of g) s.relations[o.id] = randint(-30,40);
        pushLog(`Nouvelle √©toile ${s.name} cr√©√©e.`);
        setNotif("Syst√®me cr√©√©");
        return [...g, s];
      });
    };

    const resetGalaxy = () => {
      if (!confirm("R√©initialiser la galaxie locale ? (perdra la progression locale)")) return;
      const g = createGalaxy();
      setGalaxy(g);
      localStorage.setItem("galaxy_v5_local", JSON.stringify(g));
      localStorage.setItem("galaxy_v5_last", now());
      pushLog("Galaxie r√©initialis√©e localement.");
      setNotif("R√©initialis√©e");
    };

    // fast-forward local (dev)
    const fastForward = (hours) => {
      const g = evolveGalaxy(galaxy, hours);
      setGalaxy(g);
      pushLog(`Avance rapide: ${hours}h.`);
      setNotif(`${hours}h appliqu√©es`);
    };

    return (
      <div className="w-full h-full relative select-none">
        {/* Topbar */}
        <div className="absolute top-3 left-3 right-3 z-60 flex justify-between items-center gap-4">
          <div className="flex items-center gap-3">
            <div className="text-2xl font-bold text-cyan-300">üåå La Galaxie Vivante ‚Äî V5</div>
            <div className="text-sm text-gray-300">Local-first ‚Äî pr√©par√©e pour cloud partag√©</div>
          </div>

          <div className="flex items-center gap-2">
            <div className="text-xs text-gray-300 mr-2">Mode: <span className="font-semibold">{syncMode}</span></div>
            <button onClick={()=> fastForward(6)} className="px-3 py-1 bg-slate-700 rounded text-sm">+6h</button>
            <button onClick={()=> fastForward(24)} className="px-3 py-1 bg-amber-700 rounded text-sm">+24h</button>
            <button onClick={addSystem} className="px-3 py-1 bg-green-700 rounded text-sm">Ajouter syst√®me</button>
            <button onClick={resetGalaxy} className="px-3 py-1 bg-red-700 rounded text-sm">Reset local</button>

            {/* Cloud controls - visibles m√™me si keys manquantes */}
            <div className="ml-3 flex items-center gap-1">
              <input type="text" placeholder="sharedId" value={sharedId} onChange={(e)=>setSharedId(e.target.value)} className="text-xs p-1 rounded bg-black bg-opacity-50 w-36" />
              <button onClick={manualPullRemote} className="px-2 py-1 bg-blue-600 rounded text-xs">Pull</button>
              <button onClick={manualPushRemote} className="px-2 py-1 bg-indigo-600 rounded text-xs">Push</button>
            </div>
          </div>
        </div>

        <GalaxyMap galaxy={galaxy} onSelect={(s)=>{ setSelected(s); pushLog(`Fiche: ${s.name}`); }} camera={camera} setCamera={setCamera} highlighted={highlighted} />

        {/* Right panel */}
        <div className="absolute right-4 top-20 w-96 bg-black bg-opacity-60 p-3 rounded z-60">
          <h3 className="font-bold text-cyan-200 mb-2">Fiche Syst√®me</h3>
          {!selected && <div className="text-sm text-gray-300">Clique sur une √©toile pour afficher ses d√©tails et actions.</div>}
          {selected && (
            <>
              <div className="text-lg font-semibold">{selected.name} {selected.owner ? "‚Ä¢ " + selected.owner : ""}</div>
              <div className="text-sm text-gray-300">Population: <span className="font-medium">{selected.population.toLocaleString()}</span></div>
              <div className="text-sm text-gray-300">Niveau: <span className="font-medium">{selected.civLevel}</span></div>
              <div className="text-sm text-gray-300">Alignement: <span className="font-medium">{selected.alignment}</span></div>
              <div className="text-sm text-gray-300">√ânergie: <span className="font-medium">{selected.energy}</span></div>
              <div className="text-xs text-gray-400 mt-2">{selected.lastEvent}</div>

              <div className="mt-3 flex gap-2">
                <button onClick={()=>{ claimSystem(selected.id, "Joueur"); }} className="px-2 py-1 bg-emerald-600 rounded text-sm">Coloniser</button>
                <button onClick={()=> exploreSystem(selected.id)} className="px-2 py-1 bg-blue-600 rounded text-sm">Explorer</button>
                <button onClick={()=> sendAid(selected.id)} className="px-2 py-1 bg-cyan-600 rounded text-sm">Aider</button>
                <button onClick={()=> declareWar(selected.id)} className="px-2 py-1 bg-red-600 rounded text-sm">Guerre</button>
              </div>
            </>
          )}
        </div>

        {/* Journal */}
        <div className="absolute bottom-4 left-4 z-60 w-96 bg-black bg-opacity-60 p-3 rounded journal" style={{ maxHeight:'46vh', overflowY:'auto' }}>
          <div className="flex justify-between items-center mb-2">
            <div className="font-semibold text-cyan-200">Journal Galactique</div>
            <div className="text-xs text-gray-300">√âv√©nements r√©cents</div>
          </div>
          <div className="text-xs text-gray-200">
            {log.length === 0 && <div>Aucun √©v√©nement.</div>}
            {log.map((l,i)=> <div key={i} className="mb-1">‚Ä¢ {l}</div>)}
          </div>
        </div>

        {/* notif */}
        {notif && <div className="absolute top-16 right-6 z-70 notif bg-white bg-opacity-5 backdrop-blur-sm p-3 rounded text-sm">{notif}</div>}

        {/* help */}
        <div className="absolute bottom-4 right-4 z-60 bg-black bg-opacity-50 p-2 rounded text-xs">Zoom: roulette | Pan: glisser | Cliquer: fiche</div>
      </div>
    );
  }

  ReactDOM.render(<App />, document.getElementById('root'));
    /* ================================
   1Ô∏è‚É£  AJOUT DES RESSOURCES + B√ÇTIMENTS
===================================*/

// Donn√©es de base des b√¢timents
const BASE_BUILDINGS = {
  mine: { name: "Mine", cost: 50, baseProd: 2, resType: "minerai" },
  power: { name: "Centrale", cost: 75, baseProd: 3, resType: "energie" },
  extractor: { name: "Extracteur de cristal", cost: 100, baseProd: 1, resType: "cristal" },
  lab: { name: "Laboratoire", cost: 150, baseProd: 0.5, resType: "science" },
};

// HUD d‚Äôaffichage des ressources
function HUD({ resources }) {
  return (
    <div className="hud">
      <div>‚õèÔ∏è Minerai : {Math.floor(resources.minerai)}</div>
      <div>‚ö° √ânergie : {Math.floor(resources.energie)}</div>
      <div>üíé Cristal : {Math.floor(resources.cristal)}</div>
      <div>üß™ Science : {Math.floor(resources.science)}</div>
    </div>
  );
}

// Panneau de construction
function PlanetPanel({ selectedStar, buildings, resources, onBuild }) {
  if (!selectedStar) return null;

  return (
    <div className="panel">
      <h3>üåç {selectedStar.name}</h3>
      <p>B√¢timents :</p>
      {Object.entries(BASE_BUILDINGS).map(([key, b]) => (
        <button
          key={key}
          onClick={() => onBuild(key, b.cost)}
          disabled={resources.minerai < b.cost}
        >
          {b.name} (Co√ªt : {b.cost})
        </button>
      ))}
      <div className="building-stats">
        {Object.entries(buildings).map(([k, v]) => (
          <p key={k}>{BASE_BUILDINGS[k].name} : {v}</p>
        ))}
      </div>
    </div>
  );
}

  </script>
</body>
</html>
